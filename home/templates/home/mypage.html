{% load static %}
{% load dictionary_extras %}
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>Mypage</title>

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="{% static 'home/css/base_style.css' %}">
  <link rel="stylesheet" href="{% static 'home/css/mypage_style.css' %}">
</head>
<body>

<!-- âœ… Header -->
<header>
  <nav class="navigation">
      <a href="{% url 'dashboard' %}" class="logo"><img src="https://github.com/KSM017/ImageSource/blob/main/002.png?raw=true" alt="ë¡œê³ "></a>
      <div class="nav-links">
          <a href="{% url 'dashboard' %}">Home<span></span></a>
          <a href="{% url 'manage' %}">Manage<span></span></a>
          <a href="{% url 'mypage' %}">MyPage<span></span></a>
          <a href="{% url 'timetable' %}">TimeTable<span></span></a>
          <a href="{% url 'logout' %}">Logout<span></span></a>
      </div>
  </nav>
</header> 

<!-- âœ… ì „ì²´ ë ˆì´ì•„ì›ƒ -->
<div class="mypage-wrapper container">

  <!-- ğŸ”¹ ì™¼ìª½ íŒ¨ë„ -->
  <div class="left-panel">
    <!-- í”„ë¡œí•„ -->
    <div class="profile-section text-center">
      <img src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png" alt="í”„ë¡œí•„ ì´ë¯¸ì§€" class="profile-img mb-3">
      <h5 class="user-name">{{ user_name }}</h5>
      <p class="user-major text-muted">{{ user_major }}</p>
    </div>

    <!-- ê¸°ë³¸ ì •ë³´ -->
    <div class="info-block mt-4">
      <h6 class="block-title">ê¸°ë³¸ ì •ë³´</h6>
      <ul class="info-list">
        <li><strong>í•™ë²ˆ:</strong> {{ user_student_id }}</li>
        <li><strong>í•™ë…„:</strong> {{ user_year }}</li>
        <li><strong>ì „ê³µ:</strong> {{ user_major }}</li>
      </ul>
    </div>

    <!-- ì•Œë¦¼ -->
    <div class="info-block mt-4">
      <h6 class="block-title">ì•Œë¦¼</h6>
      <div class="alert-list">
        {% if alerts %}
          {% for msg in alerts %}
            <p class="alert-item">â€¢ {{ msg }}</p>
          {% endfor %}
        {% else %}
          <p class="alert-empty">ì•Œë¦¼ì´ ì—†ìŠµë‹ˆë‹¤.</p>
        {% endif %}
      </div>
    </div>

    <!-- GPA ì°¨íŠ¸ -->
    <div class="info-block mt-4">
      <h6 class="block-title">í•™ê¸°ë³„ í‰ì  ì¶”ì´</h6>
      <div class="chart-area">
        <canvas id="topGpaChart" width="260" height="160"></canvas>
      </div>
    </div>
  </div>

  <!-- ğŸ”¸ ì˜¤ë¥¸ìª½ íŒ¨ë„ -->
  <div class="right-panel">
    <div class="section-box">
      <h4>ì´ìˆ˜ ê³¼ëª© í˜„í™©</h4>
      <div class="row">
        <div class="col-md-4">
          <div class="card">
            <div class="p-3">
              <div class="summary-box mb-3">
                <p class="mb-1"><strong>ì´ ì´ìˆ˜ í•™ì :</strong> <span id="mypage-total-credits">0</span></p>
                <p class="mb-0"><strong>ì „ì²´ í‰ì  í‰ê· :</strong> <span id="mypage-total-gpa">0.00</span></p>
              </div>
              <h6 class="text-muted">í•™ê¸° ëª©ë¡</h6>
              <ul id="mypage-semester-list" class="list-group" style="max-height: 250px; overflow-y: auto;"></ul>
            </div>
          </div>
        </div>

        <div class="col-md-8">
          <div class="card">
            <div class="p-3">
              <div class="d-flex justify-content-between align-items-center mb-3">
                <div class="summary-box">
                  <h5 id="mypage-semester-title">í•™ê¸°ë¥¼ ì„ íƒí•˜ì„¸ìš”</h5>
                  <p class="mb-0 text-muted">ì´ìˆ˜ í•™ì : <span id="mypage-semester-credits">0</span> | í‰ì  í‰ê· : <span id="mypage-semester-gpa">0.00</span></p>
                </div>
              </div>
              <div id="mypage-course-list" style="max-height: 300px; overflow-y: auto;"></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="section-box mt-4">
      <h4>ì¡¸ì—… ìš”ê±´ ì´ìˆ˜ í˜„í™©</h4>
      <table class="table table-bordered">
        <thead>
          <tr>
            <th>êµ¬ë¶„</th>
            <th>ì´ìˆ˜ í•™ì </th>
            <th>ì¡¸ì—… ê¸°ì¤€</th>
            <th>ë¯¸ì´ìˆ˜</th>
            <th>ì¶©ì¡±</th>
          </tr>
        </thead>
        <tbody id="requirements-table-body">
          <!-- JSë¡œ ë Œë”ë§ -->
        </tbody>
      </table>
    </div>
  </div>
</div>

<!-- JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script id="course-history-data" type="application/json">{{ course_history_json|safe }}</script>
<script id="requirements-tree-data" type="application/json">{{ requirements_tree_json|safe }}</script>
<script src="{% static 'home/js/mypage.js' %}"></script>

</body>
</html>
